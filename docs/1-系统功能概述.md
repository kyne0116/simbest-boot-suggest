# 智能领导推荐系统功能概述

## 1. 系统简介

智能领导推荐系统是一个基于 Java Spring Boot 开发的企业级应用，旨在通过智能算法为企业内部的任务审批流程提供领导推荐服务。系统通过分析任务标题、组织结构、职责领域和历史批复记录，为用户推荐最合适的领导进行任务审批，提高工作效率和准确性。

系统采用 JPA（Java Persistence API）进行对象关系映射，在应用启动时自动创建数据库表结构。系统基于"先有对象模型，后有数据库表"的设计理念，所有数据库表都是由 JPA 根据实体类定义自动生成的。

系统当前版本为 2.0.0，支持多租户部署，提供完整的 RESTful API 接口，可以轻松集成到企业现有的工作流系统中。

## 2. 核心功能模块

### 2.1 推荐系统

推荐系统是本应用的核心功能，主要包括以下特性：

- **多策略融合推荐**：结合组织关系、职责领域、历史批复和文本相似度等多种策略进行推荐
- **单个/多个推荐模式**：支持返回单个最佳匹配的领导或多个候选领导
- **工作流方向感知**：支持上行（向上级推荐）、下行（向下级推荐）和平行（向同级推荐）三种工作流方向
- **动态阈值计算**：根据任务标题长度动态调整匹配阈值
- **推荐理由生成**：为每个推荐结果生成详细的推荐理由，提高推荐透明度
- **置信度评估**：为每个推荐结果提供置信度评分，帮助用户判断推荐质量

### 2.2 组织管理

组织管理模块负责管理企业的组织结构，主要功能包括：

- **组织层级管理**：支持多级组织结构的管理，包括公司、部门、团队等
- **组织关系维护**：维护组织之间的父子关系，构建完整的组织树
- **组织领导关系**：管理组织的主管领导、上级分管领导和副领导
- **组织关键词管理**：为组织设置关键词及权重，用于任务匹配
- **组织与职责领域关联**：建立组织与职责领域的多对多关系，并设置权重

### 2.3 职责领域管理

职责领域是系统的核心概念之一，用于描述业务范围，主要功能包括：

- **职责领域定义**：创建和管理职责领域，包括领域名称、描述等信息
- **领域关键词管理**：为职责领域设置关键词，用于任务匹配
- **领域与领导关联**：建立职责领域与领导的多对多关系
- **领域与组织关联**：建立职责领域与组织的多对多关系，并设置权重

### 2.4 批复历史管理

批复历史管理模块负责记录和分析历史批复数据，主要功能包括：

- **批复记录存储**：存储任务批复的历史记录，包括任务信息、审批人、批复结果等
- **历史数据分析**：分析历史批复记录，提取任务模式和审批偏好
- **基于历史的推荐**：利用历史批复记录进行推荐，提高推荐准确性

### 2.5 推荐反馈管理

推荐反馈管理模块负责收集和分析用户对推荐结果的反馈，主要功能包括：

- **反馈收集**：收集用户对推荐结果的接受/拒绝反馈和评分
- **反馈分析**：分析反馈数据，计算推荐接受率和评分统计
- **推荐优化**：根据反馈数据优化推荐算法

### 2.6 系统配置管理

系统配置管理模块负责管理系统的各种配置项，主要功能包括：

- **算法权重配置**：配置推荐算法中各个因素的权重
- **阈值配置**：配置推荐系统的各种阈值参数
- **显示配置**：配置推荐结果的显示方式
- **推荐原因模板**：配置推荐理由的文本模板

### 2.7 多租户支持

系统支持多租户架构，主要功能包括：

- **租户管理**：创建和管理租户，包括租户信息、状态等
- **数据隔离**：通过租户代码实现不同租户之间的数据隔离
- **租户配置**：支持租户级别的系统配置

## 3. 推荐算法说明

系统的推荐算法采用多策略融合的方式，主要包括以下几种策略：

### 3.1 基于组织-领域关联的推荐

1. 计算每个组织与任务标题的匹配度
2. 根据组织匹配度和组织-领域关联找到相关领导
3. 结合组织匹配分数和个人-领域匹配分数生成最终推荐结果

### 3.2 基于职责领域的推荐

1. 分析任务标题，提取关键词
2. 计算每个领导的职责领域与任务标题的匹配度
3. 选择匹配度最高的领导进行推荐

### 3.3 基于历史批复的推荐

1. 分析历史批复记录，提取任务模式
2. 计算当前任务与历史任务模式的相似度
3. 根据相似度和历史审批人信息生成推荐结果

### 3.4 基于文本相似度的推荐

1. 使用自然语言处理技术分析任务标题
2. 计算任务标题与领导职责描述的文本相似度
3. 选择相似度最高的领导进行推荐

## 4. 系统接口

系统提供了一系列 RESTful API 接口，主要包括：

### 4.1 推荐接口

- `/recommend/getRecommendation`：获取领导推荐
- `/recommend/organizations`：获取所有组织
- `/recommend/leaders`：获取所有领导
- `/recommend/info`：获取系统信息
- `/recommend/check-org`：检查组织 ID 是否存在
- `/recommend/test-match`：测试关键词匹配
- `/recommend/validate-tenant`：验证租户是否有效
- `/recommend/feedback-stats`：获取推荐反馈统计信息

### 4.2 批复历史接口

- `/approval-history`：保存批复历史记录
- `/approval-history/{id}`：获取指定 ID 的批复历史记录
- `/approval-history/tenant/{tenantCode}`：获取指定租户的批复历史记录
- `/approval-history/approver`：根据审批人查找批复历史记录
- `/approval-history/time-range`：根据时间范围查找批复历史记录

### 4.3 反馈接口

- `/feedback`：保存推荐反馈
- `/feedback/{id}`：获取指定 ID 的推荐反馈
- `/feedback/tenant/{tenantCode}`：获取指定租户的推荐反馈
- `/feedback/tenant/{tenantCode}/page`：分页获取指定租户的推荐反馈
- `/feedback/time-range`：根据时间范围查找推荐反馈
- `/feedback/rating`：根据评分查找推荐反馈
- `/feedback/acceptance-rate`：计算推荐接受率

### 4.4 租户接口

- `/tenant`：创建租户
- `/tenant/{id}`：获取指定 ID 的租户
- `/tenant/code/{tenantCode}`：获取指定代码的租户
- `/tenant`：获取所有租户
- `/tenant/validate`：验证租户是否有效

### 4.5 数据初始化接口

- `/api/init/organization`：初始化组织人员数据

### 4.6 健康检查接口

- `/hello/hi`：健康检查端点
- `/hello/test`：测试端点
- `/hello/time`：获取当前时间
- `/hello/echo`：回显消息
- `/hello/info`：获取系统信息

## 5. 系统特点

- **智能推荐**：采用多策略融合的智能推荐算法，提高推荐准确性
- **灵活配置**：支持通过配置文件和数据库配置调整系统行为
- **多租户架构**：支持多租户部署，实现数据隔离
- **自动化数据初始化**：支持通过脚本和 API 自动初始化系统数据
- **完善的反馈机制**：收集和分析用户反馈，持续优化推荐算法
- **丰富的 API 接口**：提供丰富的 RESTful API 接口，便于集成
- **自动化测试框架**：内置自动化测试框架，支持从测试用例文档自动生成测试代码
- **UTF-8 编码支持**：全系统使用 UTF-8 编码，确保中文字符正常显示，避免乱码问题
- **动态阈值计算**：根据任务标题长度动态调整匹配阈值，提高推荐准确性

## 6. 技术架构

- **后端框架**：Spring Boot
- **数据持久化**：JPA (Java Persistence API)
- **数据库**：关系型数据库（如 MySQL、H2 等）
- **API 风格**：RESTful
- **自然语言处理**：自定义分词和文本相似度计算
- **测试框架**：TestNG、REST Assured
- **报告生成**：自定义 TestReportGenerator

## 7. 部署要求

- **JDK 版本**：JDK 17
- **数据库**：支持 JPA 的关系型数据库
- **内存要求**：至少 4GB RAM
- **存储要求**：至少 100MB 可用空间
- **默认端口**：12345
- **默认上下文路径**：/suggest

## 8. 自然语言分析与推荐技术

系统采用多种自然语言处理技术对任务标题进行分析，实现智能推荐功能。本系统使用的是自主研发的轻量级 NLP 框架，而非依赖第三方大型 NLP 库，以确保系统的轻量化和定制化。以下是核心技术实现的详细说明：

### 8.1 技术栈与 SDK 概述

- **核心技术栈**：

  - **Java 17**：系统基础开发语言，利用其强大的字符串处理和集合操作能力
  - **Spring Boot**：提供系统框架支持，包括配置管理、依赖注入等
  - **自研轻量级 NLP 框架**：不依赖外部 NLP 库，专为企业级推荐系统定制开发

- **文本处理组件**：

  - **自定义分词器**：基于最大正向匹配算法的轻量级中文分词实现
  - **文本相似度计算库**：自研的文本相似度算法集合，包括 Jaccard、余弦和 Levenshtein 算法
  - **同义词管理器**：自研的同义词扩展系统，支持领域特定同义词配置

- **配置与数据管理**：

  - **JSON 配置管理**：使用 Jackson 库进行 JSON 配置文件解析
  - **资源文件管理**：使用 Java 标准库的资源加载机制管理词典和同义词表
  - **UTF-8 编码处理**：全面支持 UTF-8 编码，确保中文处理无乱码

- **算法实现特点**：
  - **轻量化设计**：所有算法均为轻量级实现，无需外部依赖
  - **可配置性**：算法参数通过配置文件灵活调整
  - **领域特化**：针对企业任务标题分析进行了特殊优化

### 8.2 中文分词技术

系统使用自定义的中文分词器（ChineseTokenizer）对任务标题进行分词处理：

- **最大正向匹配算法**：采用最大正向匹配算法进行中文分词，支持最大词长配置
- **自定义词典**：通过 dictionary.txt 文件维护领域特定词汇，包括网络安全、计费账务、系统管理、数据治理等多个领域的专业术语
- **动态词典扩展**：支持在运行时动态添加新词汇，提高分词准确性
- **UTF-8 编码支持**：全面支持中文字符处理，确保中文分词结果准确无误

### 8.3 文本相似度计算

系统采用多种文本相似度算法的融合计算方式，提高匹配准确性：

- **字符级相似度**：

  - Jaccard 相似度：计算两个文本的字符集合交集与并集的比值
  - 余弦相似度：将文本转换为向量，计算向量夹角的余弦值
  - Levenshtein 距离：计算两个字符串的编辑距离，并转换为相似度

- **词语级相似度**：

  - 基于分词的 Jaccard 相似度：计算分词结果的集合相似度
  - 基于分词的余弦相似度：计算分词向量的余弦相似度
  - 基于分词的 Levenshtein 相似度：计算分词序列的编辑距离

- **综合相似度计算**：
  - 字符级相似度与词语级相似度的加权平均
  - 权重可通过 algorithm-weights.json 配置文件动态调整
  - 默认配置：字符级权重 0.4，词语级权重 0.6

### 8.4 关键词匹配算法

系统采用多维度的关键词匹配算法，提高匹配的灵活性和准确性：

- **匹配方式**：

  - 直接匹配：关键词直接出现在任务标题中
  - 分词匹配：关键词出现在任务标题的分词结果中
  - 同义词匹配：关键词的同义词出现在任务标题中

- **权重计算**：

  - 关键词长度权重：关键词越长，权重越高
  - 匹配方式权重：直接匹配权重最高，同义词匹配权重最低
  - 关键词自定义权重：可为每个关键词设置自定义权重

- **匹配分数计算**：
  - 关键词数量比率：匹配的关键词数量占总关键词数量的比例
  - 加权匹配分数：考虑关键词权重的加权匹配分数
  - 综合评分：关键词数量比率和加权匹配分数的加权平均

### 8.5 同义词管理

系统通过同义词管理机制增强文本匹配的语义理解能力：

- **同义词表**：通过 synonyms.txt 文件维护领域特定的同义词组
- **同义词匹配**：在关键词匹配和文本相似度计算中考虑同义词关系
- **动态同义词扩展**：支持在运行时动态添加新的同义词组
- **领域特化**：针对不同业务领域维护特定的同义词组，如"网络安全,信息安全,网信安全,互联网信安"

### 8.6 动态阈值计算

系统根据任务标题的长度动态调整匹配阈值，提高推荐的准确性：

- **长度分级**：

  - 短文本（<10 字符）：使用较高阈值（0.3）
  - 中等文本（10-50 字符）：使用中等阈值（0.2）
  - 长文本（>50 字符）：使用较低阈值（0.1）

- **阈值应用**：
  - 在关键词匹配中应用动态阈值
  - 在文本相似度计算中应用动态阈值
  - 在最终推荐结果筛选中应用动态阈值

### 8.7 多策略融合推荐

系统采用多策略融合的方式进行推荐，综合考虑多种因素：

- **策略组合**：

  - 基于组织-领域关联的推荐
  - 基于职责领域的推荐
  - 基于历史批复的推荐
  - 基于文本相似度的推荐

- **权重配置**：

  - 组织匹配权重：0.8
  - 历史匹配权重：0.7
  - 领域匹配权重：0.6
  - 文本相似度权重：0.4

- **结果融合**：
  - 多策略并行执行
  - 结果去重与合并
  - 根据匹配分数排序
  - 返回排序后的前 N 个结果

### 8.8 推荐理由生成

系统为每个推荐结果生成详细的推荐理由，提高推荐透明度：

- **理由模板**：针对不同推荐策略预定义理由模板
- **参数替换**：根据实际推荐结果替换模板中的参数
- **理由优化**：根据匹配分数调整理由的表述方式
- **UTF-8 编码支持**：确保中文推荐理由正常显示，避免乱码问题

### 8.9 算法配置与优化

系统支持通过配置文件动态调整算法参数，实现灵活配置：

- **配置文件**：

  - application.properties：基本配置参数
  - algorithm-weights.json：算法权重配置

- **可配置参数**：

  - 文本相似度算法权重
  - 关键词匹配算法参数
  - 分词器配置
  - 阈值配置

- **反馈优化**：
  - 收集用户对推荐结果的反馈
  - 分析不同推荐策略的成功率
  - 根据反馈数据调整算法权重
  - 持续优化推荐算法

### 8.10 技术实现与集成

系统的自然语言分析与推荐技术在实际实现中采用了以下技术方案：

- **核心实现技术**：

  - **Java 标准库**：使用 Java 17 标准库中的 String、List、Map 等数据结构实现算法
  - **Jackson**：用于解析和处理 JSON 格式的配置文件
  - **Lombok**：简化模型类和日志记录的代码编写
  - **SLF4J**：提供统一的日志记录接口

- **集成方式**：

  - **Spring 依赖注入**：通过 Spring 的依赖注入机制集成各个组件
  - **服务层设计**：将 NLP 功能封装在独立的服务层中，便于调用和测试
  - **RESTful API**：通过 RESTful API 暴露自然语言分析功能，支持外部系统集成

- **性能优化**：

  - **缓存机制**：对分词结果和同义词查询进行缓存，提高性能
  - **延迟加载**：词典和同义词表采用延迟加载策略，减少启动时间
  - **并行计算**：在多策略推荐中支持并行计算，提高响应速度

- **可扩展性设计**：
  - **插件式架构**：支持添加新的相似度算法和匹配策略
  - **接口抽象**：核心功能通过接口抽象，便于替换实现
  - **配置驱动**：通过配置文件控制算法行为，无需修改代码
